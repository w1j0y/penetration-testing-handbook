# Authentication Bypass via Direct Access
For instance, let us assume that we know that the web application redirects users to the /admin.php endpoint after successful authentication, providing protected information only to authenticated users. If the web application relies solely on the login page to authenticate users, we can access the protected resource directly by accessing the /admin.php endpoint.
This code redirects the user to /index.php if the session is not active, i.e., if the user is not authenticated. However, the PHP script does not stop execution, resulting in protected information within the page being sent in the response body:
As we can see, the entire admin page is contained in the response body. However, if we attempt to access the page in our web browser, the browser follows the redirect and displays the login prompt instead of the protected admin page.
We can easily trick the browser into displaying the admin page by intercepting the response and changing the status code from 302 to 200. To do this, enable Intercept in Burp. Afterward, browse to the /admin.php endpoint in the web browser. Next, right-click on the request and select Do intercept > Response to this request to intercept the response:
Afterward, forward the request by clicking on Forward.
Since we intercepted the response, we can now edit it. To force the browser to display the content, we need to change the status code from 302 Found to 200 OK:
Afterward, we can forward the response. If we switch back to our browser window, we can see that the protected information is rendered:
To prevent the protected information from being returned in the body of the redirect response, the PHP script needs to exit after issuing the redirect:
# Authentication Bypass via Parameter Modification
## Parameter Modification
Based on the parameter name user_id, we can infer that the parameter specifies the ID of the user accessing the page. If we can guess or brute-force the user ID of an administrator, we might be able to access the page with administrative privileges, thus revealing the admin information. We can use the techniques discussed in the Brute-Force Attacks sections to obtain an administrator ID. Afterward, we can obtain administrative privileges by specifying the admin's user ID in the user_id parameter.
# Exercise
To determine the id of the admin, the tester intercepted the GET request
Using the error in the Response to include it in the filter results parameter, the tester ran the following ffuf command
ffuf -w ./ids.txt:FUZZ -u 'http://94.237.53.230:46646/admin.php?user_id=FUZZ' -fr 'Could not load admin data. Please check your privileges.'