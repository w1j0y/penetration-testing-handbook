# Default Credentials
## Testing Default Credentials
Many platforms provide lists of default credentials for a wide variety of web applications. Such an example is the web database maintained by CIRT.net.
Further resources include SecLists Default Credentials as well as the SCADA GitHub repository which contains a list of default passwords for a variety of different vendors.
# Vulnerable Password Reset
## Guessable Password Reset Questions
Often, web applications authenticate users who have lost their passwords by requesting that they answer one or multiple security questions. During registration, users provide answers to predefined and generic security questions, disallowing users from entering custom ones. Therefore, within the same web application, the security questions of all users will be the same, allowing attackers to abuse them.
Assuming we had found such functionality on a target website, we should try abusing it to bypass authentication.
For instance, assuming a web application uses a security question like What city were you born in?
```
https://github.com/datasets/world-cities/blob/main/data/world-cities.csv
```
Since the CSV file contains the city name in the first field, we can create our wordlist containing only the city name on each line using the following command:
```
cat world-cities.csv | cut -d ',' -f1 > city_wordlist.txt
```
As an example, we will target the user admin. After specifying the username, we must answer the user's security question. The corresponding request looks like this:
We can set up the corresponding ffuf command from this request to brute-force the answer. Keep in mind that we need to specify our session cookie to associate our request with the username admin we specified in the previous step: (-fr is determined from the Burp Suite Response error)
```
ffuf -w ./city_wordlist.txt -u http://pwreset.htb/security_question.php -X POST -H "Content-Type: application/x-www-form-urlencoded" -b "PHPSESSID=39b54j201u3rhu4tab1pvdb4pv" -d "security_response=FUZZ" -fr "Incorrect response."
```
We could narrow down the cities if we had additional information on our target to reduce the time required for our brute-force attack on the security question. For instance, if we knew that our target user was from Germany, we could create a wordlist containing only German cities, reducing the number to about a thousand cities:
```
cat world-cities.csv | grep Germany | cut -d ',' -f1 > german_cities.txt
```
# Manipulating the Reset Request
Another instance of a flawed password reset logic occurs when a user can manipulate a potentially hidden parameter to reset the password of a different account.
We will use our demo account htb-stdnt, which results in the following request:
Afterward, we need to supply the response to the security question:
Supplying the security response London results in the following request:
As we can see, the username is contained in the form as a hidden parameter and sent along with the security response. Finally, we can reset the user's password:
The final request looks like this:
Like the previous request, the request contains the username in a separate POST parameter. Suppose the web application does properly verify that the usernames in both requests match. In that case, we can skip the security question or supply the answer to our security question and then set the password of an entirely different account. For instance, we can change the admin user's password by manipulating the username parameter of the password reset request:
