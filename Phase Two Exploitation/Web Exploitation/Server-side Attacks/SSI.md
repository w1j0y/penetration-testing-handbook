# Server-Side Includes (SSI) Injection
Similar to server-side templates, server-side includes (SSI) can be used to generate HTML responses dynamically. SSI directives instruct the webserver to include additional content dynamically. These directives are embedded into HTML files. For instance, SSI can be used to include content that is present in all HTML pages, such as headers or footers. When an attacker can inject commands into the SSI directives, Server-Side Includes (SSI) Injection can occur. SSI injection can lead to data leakage or even remote code execution.
Server-Side Includes (SSI) is a technology web applications use to create dynamic content on HTML pages. SSI is supported by many popular web servers such as Apache and IIS. The use of SSI can often be inferred from the file extension. Typical file extensions include .shtml, .shtm, and .stm. However, web servers can be configured to support SSI directives in arbitrary file extensions. As such, we cannot conclusively conclude whether SSI is used only from the file extension.
# SSI Directives
SSI utilizes directives to add dynamically generated content to a static HTML page. These directives consist of the following components:
name: the directive's name
parameter name: one or more parameters
value: one or more parameter values
An SSI directive has the following syntax:
```
<!--#name param1="value1" param2="value" -->
```
the following are some common SSI directives.
### printenv
```
<!--#printenv -→
```
### config
```
<!--#config errmsg="Error!" -→
```
### echo
This directive prints the value of any variable given in the var parameter. Multiple variables can be printed by specifying multiple var parameters. For instance, the following variables are supported:
```
DOCUMENT_NAME: the current file's name
DOCUMENT_URI: the current file's URI
LAST_MODIFIED: timestamp of the last modification of the current file
DATE_LOCAL: local server time
```

```
<!--#echo var="DOCUMENT_NAME" var="DATE_LOCAL" -→
```
Summary
SSI injection occurs when an attacker can inject SSI directives into a file that is subsequently served by the web server, resulting in the execution of the injected SSI directives. This scenario can occur in a variety of circumstances. For instance, when the web application contains a vulnerable file upload vulnerability that enables an attacker to upload a file containing malicious SSI directives into the web root directory. Additionally, attackers might be able to inject SSI directives if a web application writes user input to a file in the web root directory.
### exec
```
<!--#exec cmd="whoami" -→
```
### include
```
<!--#include virtual="index.html" -→
```
# Exploiting SSI Injection
If we enter our name, we are redirected to /page.shtml, which displays some general information
We can guess that the page supports SSI based on the file extension. If our username is inserted into the page without prior sanitization, it might be vulnerable to SSI injection. Let us confirm this by providing a username of `<!--#printenv -->`
As we can see, the directive is executed, and the environment variables are printed. Thus, we have successfully confirmed an SSI injection vulnerability. Let us confirm that we can execute arbitrary commands using the exec directive by providing the following username: `<!--#exec cmd="id" -->`
The server successfully executed our injected command. This enables us to take over the web server fully.
# Prevention