# Session Hijacking
In session hijacking attacks, the attacker takes advantage of insecure session identifiers, finds a way to obtain them, and uses them to authenticate to the server and impersonate the victim.
Using Web Developer Tools (Shift+Ctrl+I in the case of Firefox), notice that the application is using a cookie named auth-session most probably as a session identifier. Double click this cookie's value and copy it!
Using Web Developer Tools (Shift+Ctrl+I in the case of Firefox), replace the current auth-session cookie's value with the one you copied in Part 1. Reload the current page, and you will notice that you are logged in as "Julie Rogers" without using any credentials!
# Session Fixation
Session Fixation occurs when an attacker can fixate a (valid) session identifier. As you can imagine, the attacker will then have to trick the victim into logging into the application using the aforementioned session identifier. If the victim does so, the attacker can proceed to a Session Hijacking attack (since the session identifier is already known).
## Part 1: Session fixation identification
Using Web Developer Tools (Shift+Ctrl+I in the case of Firefox), notice that the application uses a session cookie named PHPSESSID and that the cookie's value is the same as the token parameter's value on the URL.
If any value or a valid session identifier specified in the token parameter on the URL is propagated to the PHPSESSID cookie's value, we are probably dealing with a session fixation vulnerability.
## Part 2: Session fixation exploitation attempt
Open a New Private Window and navigate to http://oredirect.htb.net/?redirect_uri=/complete.html&token=IControlThisCookie
Using Web Developer Tools (Shift+Ctrl+I in the case of Firefox), notice that the PHPSESSID cookie's value is IControlThisCookie
We are dealing with a Session Fixation vulnerability. An attacker could send a URL similar to the above to a victim. If the victim logs into the application, the attacker could easily hijack their session since the session identifier is already known (the attacker fixated it).
Note: Another way of identifying this is via blindly putting the session identifier name and value in the URL and then refreshing.
# Obtaining Session Identifiers without User Interaction
## Obtaining Session Identifiers via Traffic Sniffing
### To sum up, obtaining session identifiers through traffic sniffing requires:
1. The attacker must be positioned on the same local network as the victim
2. Unencrypted HTTP traffic
There are numerous packet sniffing tools. In this module, we will use Wireshark. Wireshark has an inbuilt filter function that allows users to filter traffic for a specific protocol such as HTTP, SSH, FTP, and even for a particular source IP address.
### Part 1: Simulate the attacker
1. Navigate to [http://xss.htb.net](http://xss.htb.net/) and, using Web Developer Tools (Shift+Ctrl+I in the case of Firefox), notice that the application uses a cookie named `auth-session` most probably as a session identifier.
2. Now fire up Wireshark to start sniffing traffic on the local network as follows.
```
sudo -E wireshark
```
3. Right-click "tun0" and then click "Start capture”
### Part 2: Simulate the victim
1. Navigate to http://xss.htb.net through a New Private Window and login to the application using the credentials below:
```
Email: heavycat106
```
```
Password: rocknrol
```
### Part 3: Obtain the victim's cookie through packet analysis
1. Inside Wireshark, first, apply a filter to see only HTTP traffic. This can be done as follows (don't forget to press Enter after specifying the filter).
2. Now search within the Packet bytes for any `auth-session` cookies as follows.
3. Navigate to `Edit -> Find Packet`
4. Left-click on Packet list and then click Packet bytes
5. Select String on the third drop-down menu and specify auth-session on the field next to it. Finally, click Find. Wireshark will present you with the packets that include an auth-session string.
6. The cookie can be copied by right-clicking on a row that contains it, then clicking on Copy and finally clicking Value. 
### Part 4: Hijack the victim's session
Back to the browser window using which you first browsed the application (not the Private Window), open Web Developer Tools, navigate to storage, and change your current cookie's value to the one you obtained through Wireshark (remember to remove the auth-session= part).
If you refresh the page, you will see that you are now logged in as the victim!